# 业务场景

双 11 活动日，销售手机充值卡的商家对移动、联通、电信的 30 元、50 元、100 元商品推出抢购活动，每种商品的抢购上限为 100。

## 解决方案

- 以商家 id 作为 key
- 将参与抢购的商品作为 field
- 将参与抢购的商品数量作为对应的 value
- 抢购时使用降值的方式控制产品数量
- 实际业务中还有超卖等实际问题，这里不做讨论

如下代码

```shell
# p01商家下，c30充值券1000张，c50充值券1000张，c100充值券1000张
hmset p01 c30 1000 c50 1000 c100 1000
```

当 c30 售出一件时，则减 1，如下代码

```shell
# p01商家，商品c30售出1件
hincrby p01 c30 -1
# p01商家，商品c100售出20件
hincrby p01 c100 -20
```

## string 存对象于 hash 存对象

- string 存储 json 字符串：读取方便，在更新的时候会整体进行更新

- hash 存对象具体的字段：更新灵活
